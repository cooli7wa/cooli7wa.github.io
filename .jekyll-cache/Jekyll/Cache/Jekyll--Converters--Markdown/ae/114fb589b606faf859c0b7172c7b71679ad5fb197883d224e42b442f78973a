I"İm<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<p><a href="http://neuralnetworksanddeeplearning.com/chap1.html">åŸæ–‡åœ°å€</a></p>

<h3 id="perceptronsæ„ŸçŸ¥å™¨">perceptronsï¼ˆæ„ŸçŸ¥å™¨ï¼‰</h3>

<p>1950s-1960s by scientist Frank Rosenblatt</p>

<p><img src="/images/md/chap1_perceptron.png" alt="" /></p>

<p>æ•°å­¦æ¨¡å‹ï¼š</p>

<p><img src="/images/md/chap1_perceptron_1.png" alt="" /></p>

<p>æ‰€æœ‰æƒé‡å‚æ•°ä¸ºw1,w2â€¦ï¼Œthreshold</p>

<p>thresholdï¼ŒDropping the threshold means youâ€™re more willing to go to the festival.</p>

<p>ä¸æƒé‡bæ˜¯åŒä¸€ç§æ„æ€ï¼Œä¸€ä¸ªè¡¨ç¤ºåå¥½çš„æƒé‡</p>

<p>æ„ŸçŸ¥æœºçš„è¾“å…¥åªæ˜¯0æˆ–1ï¼Œè¾“å‡ºä¹Ÿæ˜¯0æˆ–1</p>

<p><img src="/images/md/chap1_perceptron_2.png" alt="" /></p>

<p>ä¸¤å¤„ç®€åŒ–</p>

<p>[\sum_{j} w_{j}x_{j} \equiv w\cdot x]</p>

<p>[b \equiv -threshold]</p>

<p>è¿™ä¸ªbiasä»£è¡¨çš„æ˜¯how easy it is to get the perceptron to fire</p>

<p>perceptronçš„ä¸¤ç§ç”¨é€”ï¼š</p>
<ul>
  <li>a method for weighing evidence to make decisions</li>
  <li>compute simple logical functions, depend on NAND gate</li>
</ul>

<p>perceptronsèƒ½å®ç°ä¸éé—¨ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯ä»…ä»…çš„åªæ˜¯å®ç°å¦ä¸€ç§é›†æˆç”µè·¯ï¼Œä¸ä¼ ç»Ÿçš„åŸºäºä¸éé—¨çš„é›†æˆç”µè·¯ä¸åŒçš„æ˜¯ï¼Œperceptronsèƒ½å¤Ÿé€šè¿‡è‡ªåŠ¨è°ƒèŠ‚weightså’Œbiasesï¼Œæ¥è‡ªåŠ¨å­¦ä¹ è§£å†³é—®é¢˜</p>

<h3 id="sigmoid-neurons">sigmoid neurons</h3>

<p>In fact, a small change in the weights or bias of any single perceptron in the network can sometimes cause the output of that perceptron to completely flip, say from 00 to 11.
sigmoidï¼šSigmoid neurons are similar to perceptrons, but modified so that small changes in their weights and bias cause only a small change in their output.</p>

<p>perceptronsçš„é—®é¢˜æ˜¯ï¼Œå®ƒæ˜¯é˜¶æ¢¯å˜åŒ–çš„ï¼Œä¸çº¿æ€§ï¼Œå¾®å°çš„å˜åŒ–ä¸èƒ½å¾ˆå¥½çš„è¡¨ç°å‡ºæ¥ã€‚</p>

<p>sigmoidè¾“å‡º0-1ä¹‹é—´çš„ä»»æ„æ•°ï¼ŒÏƒ(wâ‹…x+b)</p>

<p>[\sigma (z) \equiv \frac{1}{1+e^{-z}}]</p>

<p>[\sigma (z) \equiv \frac{1}{1+e^{-\sum_{j}w_{j}x_{j}-b}}]</p>

<p><img src="/images/md/chap1_sigmoid_1.png" alt="" /></p>

<p>sigmoidçš„ä¸€ä¸ªæ¯”perceptronsä¸æ–¹ä¾¿çš„åœ°æ–¹æ˜¯ï¼Œoutputä¸æ˜¯0æˆ–1ï¼Œè€Œæ˜¯ä¸€ä¸ªä»‹äº0-1ä¹‹é—´çš„æ•°ï¼Œå°±æŒ‡ç¤ºä¸€ä¸ªå¯¹é”™çš„ç™¾åˆ†æ¯”è€Œå·²</p>

<p>perceptronså’Œsigmoidçš„ä¸€äº›ç‰¹æ€§</p>
<ul>
  <li>perceptronsçš„w bä¹˜ä»¥ä»»æ„æ­£æ•°cï¼Œä¸å½±å“è¾“å‡ºï¼Œsigmoidå°±ä¼šæœ‰å½±å“</li>
  <li>å®é™…ä¸Šsigmoidå¦‚æœä¹˜ä»¥cï¼Œä¸”cè¶‹äºæ­£æ— ç©·ï¼Œé‚£ä¹ˆsigmoidä¸perceptronså°±ä¸€æ ·äº†</li>
</ul>

<p>MLPsï¼šmultilayer perceptrons</p>

<p>æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯feedforwardç½‘ç»œï¼Œä¹Ÿå°±æ˜¯åªæœ‰å‰è¿›æ²¡æœ‰åé€€çš„
è¿˜æœ‰ä¸€ç§æ˜¯Recurrent neural netsï¼Œè¿™é‡ŒåŒ…å«loopsï¼Œè¿™ä¸ªloopsæŒç»­ä¸€æ®µè¢«é™åˆ¶çš„æ—¶é—´ï¼Œä¸æ˜¯ä¸€ç›´å¾ªç¯ä¸‹å»ï¼Œç¥ç»å…ƒæœ¬èº«ä¼šå—åˆ°ä¹‹å‰çš„æ¿€å‘çŠ¶æ€çš„å½±å“æˆ–è€…å—åˆ°ä¹‹å‰çš„è¾“å…¥çš„å½±å“ï¼ŒRecurrent neural netsï¼Œæ›´è´´è¿‘äººç±»çš„å¤§è„‘</p>

<h3 id="æ‰‹å†™æ•°å­—å¤„ç†">æ‰‹å†™æ•°å­—å¤„ç†</h3>

<p>output 10å’Œ4ï¼Œä¸ºä»€ä¹ˆä¼šå¯¼è‡´è¯†åˆ«å‡†ç¡®ç‡æœ‰åŒºåˆ«ï¼Ÿ</p>

<p>æˆ‘ä¸ªäººçš„ç†è§£æ˜¯ï¼Œhiddenå±‚æ˜¯åŸºäºç¬¬ä¸€å±‚è¾“å…¥å›¾åƒçš„æå–ç»“æœï¼Œé‚£ä¹ˆè¿™ä¸ªç»“æœæ˜¯åŸºäºå›¾åƒçš„ã€‚
è€Œ4è¿™ç§æ–¹å¼ï¼Œæ˜¯åŸºäºæ•°å­—çš„ï¼Œåœ¨è¿™å±‚æ¥åšä¸åˆé€‚ã€‚</p>

<p>åœ¨ç»ƒä¹ çš„éƒ¨åˆ†ï¼Œæœ‰æåˆ°ï¼Œå¦‚æœåŠ å…¥ç¬¬ä¸‰å±‚çš„è¯ï¼Œé‚£ä¹ˆè¿™å±‚å¯ä»¥ä½¿ç”¨4outputï¼Œå› ä¸ºç›¸å½“äºæ˜¯å°†ä¹‹å‰çš„10ä¸ªæ•°å­—çš„æ¦‚ç‡ï¼Œè¿™ç§åŸºäºæ•°å­—çš„æå–æˆå¦å¤–ä¸€ç§æ•°å­—ï¼Œè¿™æ ·æˆåŠŸç‡åº”è¯¥æ¯”è¾ƒé«˜ã€‚</p>

<h3 id="æ¢¯åº¦é€’å‡">æ¢¯åº¦é€’å‡</h3>

<p>Why not try to maximize that number directly, rather than minimizing a proxy measure like the quadratic cost?</p>

<p>æˆ‘çš„ç†è§£æ˜¯ï¼Œå¦‚æœåªå…³æ³¨ç»“æœçš„æ•°å­—çš„æœ€å¤§åŒ–çš„è¯ï¼Œé‚£ä¹ˆåšäº†äº›è®¸çš„æ”¹å˜wå’Œbï¼Œå¯¹é¢„æµ‹ç»“æœæ¥è¯´ï¼Œå¯èƒ½æ ¹æœ¬å°±æ²¡æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆå°±ä¸çŸ¥é“æ€ä¹ˆç»§ç»­æé«˜åˆ†æ•°äº†ï¼Œè¿™å°±æ˜¯è¯´è¿™ä¸ªä¸æ˜¯ä¸€ä¸ªå¹³æ»‘çš„æ–¹æ³•ã€‚</p>

<p>è€Œå¦‚æœå…³æ³¨çš„æ˜¯æ‰€æœ‰ç»“æœçš„æ•°å­—çš„å‡æ–¹å·®çš„æœ€å°åŒ–çš„è¯ï¼Œè¿™æ˜¯ä¸€ä¸ªå¹³æ»‘çš„æ–¹æ³•ï¼Œå¯ä»¥è¿›è¡Œå­¦ä¹ ã€‚</p>

<p>å‡æ–¹å·®ï¼š</p>

<p>[\frac{1}{2n}\sum \left | y(x)-a \right |^{2}]</p>

<p>æ¢¯åº¦ä¸‹é™ï¼š</p>

<p>[\Delta C \approx \bigtriangledown C\cdot \Delta v]</p>

<p>[\bigtriangledown C\equiv (\frac{\partial C}{\partial v_{1}},â€¦,\frac{\partial C}{\partial v_{m}})^{T}]</p>

<p>[\Delta v=-\eta \bigtriangledown C]</p>

<p>stochastic gradient descentï¼Œéšæœºæ¢¯åº¦é€’å‡</p>

<p>[\bigtriangledown C = \frac{1}{n} \sum_{x} \bigtriangledown C_{x}]</p>

<p>In practice, to compute the gradient âˆ‡C we need to compute the gradients âˆ‡Cx separately for each training input, x, and then average them, âˆ‡C=1nâˆ‘xâˆ‡Cx</p>

<p>ä¸€ç§æç«¯çš„mini-batchä¸º1çš„è®­ç»ƒï¼Œè¿™ç§åº”ç”¨äºonline on-line incremental learningï¼Œå°±æ˜¯éšæœºæ¢¯åº¦ä¸‹é™ï¼Œç±»ä¼¼äºäººç±»å­¦ä¹ çš„è¿‡ç¨‹</p>

<h3 id="åˆ›å»ºç½‘ç»œæ¨¡å‹">åˆ›å»ºç½‘ç»œæ¨¡å‹</h3>

<p>ä»æ–‡ç« æä¾›çš„<a href="https://github.com/mnielsen/neural-networks-and-deep-learning.git">git</a>ä¸‹è½½çš„ä»£ç ï¼Œåœ¨3.5ä¸‹ä½¿ç”¨éœ€è¦æ›´æ”¹å‡ ä¸ªåœ°æ–¹</p>

<p>å‚è€ƒè¿™ç¯‡ <a href="/images/md/chap1_mnist_35.patch">patch</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td> --><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Network</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sizes</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">num_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">sizes</span> <span class="o">=</span> <span class="n">sizes</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sizes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>è¿™é‡Œä½¿ç”¨çš„æ˜¯éšæœºé«˜æ–¯åˆ†å¸ƒï¼ˆæ­£æ€åˆ†å¸ƒï¼‰æ¥åˆå§‹åŒ–weightså’Œbiases</p>

<p>æµ‹è¯•ä¸‹éšå«å±‚çš„ç¥ç»å…ƒæ•°é‡çš„å½±å“ï¼š</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td> --><td class="rouge-code"><pre><span class="c1"># Epoch 29: 9384 / 10000
# train time: 0:03:17.5953027
# Epoch 29: 9418 / 10000
# train time: 0:03:28.126904
</span><span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">net</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre><span class="c1"># Epoch 29: 9503 / 10000
# train time: 0:04:12.572446
</span><span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">net</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre><span class="c1"># Epoch 29: 9575 / 10000
# train time: 0:05:39.106396
</span><span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">net</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td> --><td class="rouge-code"><pre><span class="c1"># Epoch 29: 8537 / 10000
# train time: 0:07:48.387790
# Epoch 29: 9599 / 10000
# train time: 0:07:44.628575
</span><span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">net</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä»ç»“æœçœ‹ï¼Œéšå«å±‚ç¥ç»å…ƒè¶Šå¤šï¼Œæµ‹è¯•ç»“æœä¸€èˆ¬è¶Šå¥½ï¼Œä½†æ˜¯èŠ±è´¹æ—¶é—´è¶Šå¤šã€‚</strong></p>

<p>éšå«å±‚ç¥ç»å…ƒè¶Šå¤šï¼Œæ„å‘³ç€ä»inputå±‚è·å–åˆ°çš„Featureçš„ç§ç±»å°±è¶Šå¤šï¼Œå¯¹äºé¢„æµ‹è¶Šæœ‰å¸®åŠ©ï¼Œä½†æ˜¯ç”±äºç¥ç»å…ƒè¶Šå¤šï¼Œå‚æ•°ä¹Ÿå°±è¶Šå¤šï¼Œæ‰€ä»¥èŠ±è´¹æ—¶é—´é•¿ã€‚</p>

<p><strong>æœ€åä¸€æ¬¡å®éªŒï¼ˆå¯¹åº”ä¸­é—´å±‚æ˜¯80ï¼‰ï¼Œç»“æœä¸ç¨³å®šï¼Œä½çš„æ—¶å€™åªæœ‰85%ï¼Œå¯èƒ½æ˜¯é™·å…¥äº†å±€éƒ¨æœ€ä¼˜è§£ï¼Œä½†æ˜¯20çš„æƒ…å†µï¼Œæˆ‘æµ‹è¯•å¤šæ¬¡ä¹Ÿæ²¡æœ‰å‡ºç°ä¸ç¨³å®šçš„æƒ…å†µã€‚æ‰€ä»¥çœ‹æ¥ï¼Œæ¨¡å‹è¶Šå¤æ‚ï¼Œç²¾åº¦å¯èƒ½ä¼šè¶Šå¥½ï¼Œä½†æ˜¯è¶Šæœ‰å¯èƒ½ä¸ç¨³å®šï¼ˆé™·å…¥å±€éƒ¨æœ€ä¼˜ã€è¿‡æ‹Ÿåˆã€æ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±ç­‰ï¼‰ã€‚</strong></p>

<p>æµ‹è¯•ä¸‹batch-sizeçš„å½±å“ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre><span class="c1"># Epoch 29: 8932 / 10000
# train time: 0:04:17.280716
</span><span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">net</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre><span class="c1"># Epoch 29: 9384 / 10000
# train time: 0:03:17.5953027
</span><span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">net</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre><span class="c1"># Epoch 29: 9376 / 10000
# train time: 0:03:11.990982
</span><span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">net</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre><span class="c1"># Epoch 29: 9383 / 10000
# train time: 0:02:57.594158
</span><span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">net</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td> --><td class="rouge-code"><pre><span class="c1"># Epoch 29: 9270 / 10000
# train time: 0:03:08.102759
</span><span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="p">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">net</span><span class="p">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>ä»ç»“æœçœ‹ï¼Œéšç€sizeå¢åŠ ï¼Œæ•´ä½“æ¥çœ‹ï¼Œç›¸åŒepochçš„æ—¶é—´åœ¨ä¸‹é™ï¼Œç²¾åº¦ä¹Ÿæœ‰ä¸‹é™è¶‹åŠ¿ã€‚æ‰€ä»¥è¿™ä¹ˆçœ‹çš„è¯ï¼Œsizeåº”è¯¥æœ‰ä¸ªæœ€ä¼˜å€¼ï¼Œåœ¨è¿™ç‚¹ä¸Šï¼Œè®­ç»ƒæ—¶é—´å’Œç²¾åº¦ä¼šè¾¾åˆ°æœ€ä¼˜ã€‚</strong>
<strong>å¦å¤–ä¸€ä¸ªç°è±¡æ˜¯ï¼Œåœ¨Size=1çš„æƒ…å†µä¸‹ï¼Œæ¨¡å‹æ²¡æœ‰æ”¶æ•›åˆ°åº”è¯¥æœ‰çš„æ°´å¹³ã€‚å¯èƒ½æ˜¯ç”±äºï¼Œåªæ ¹æ®ä¸€ä¸ªæ ·æœ¬æ¥æ›´æ–°å‚æ•°ï¼Œæ•´ä½“æ³¢åŠ¨æ¯”è¾ƒå¤§çš„åŸå› </strong></p>

<h3 id="toward-deep-learning">Toward deep learning</h3>

<p>In the early days of AI research people hoped that the effort to build an AI would also help us understand the principles behind intelligence and, maybe, the functioning of the human brain. But perhaps the outcome will be that we end up understanding neither the brain nor how artificial intelligence works</p>

<p>æˆ‘ä»¬äººç±»çš„ç›®çš„æ˜¯æƒ³å»ºç«‹ä¸€ä¸ªAIæ¥å¸®åŠ©æˆ‘ä»¬ç†è§£æ™ºèƒ½èƒŒåçš„åŸç†ï¼Œæ¯”å¦‚äººç±»çš„å¤§è„‘ï¼Œä½†æ˜¯è®½åˆºçš„æ˜¯ï¼Œå®é™…çš„ç»“æœæ˜¯ï¼Œæˆ‘ä»¬é€ å‡ºæ¥äº†AIï¼Œä½†æ˜¯å‘ç°æˆ‘ä»¬æ—¢ä¸ç†è§£å¤§è„‘ä¹Ÿä¸ç†è§£AIã€‚</p>

<h3 id="ministæ•°æ®é›†åˆ°å›¾åƒ">MINISTæ•°æ®é›†åˆ°å›¾åƒ</h3>

<p>å¯¹äºè¿™æœ¬ä¹¦é‡Œçš„æ•°æ®é›†ï¼Œå¯ä»¥åœ¨mnist_loader.pyé‡Œï¼ŒåŠ å…¥å¦‚ä¸‹ä»£ç </p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td> --><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">restore_image</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

    <span class="n">tr_d</span><span class="p">,</span> <span class="n">va_d</span><span class="p">,</span> <span class="n">te_d</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tr_d</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
        <span class="n">new_img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">'L'</span><span class="p">)</span>
        <span class="n">new_img</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">restore_image</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>fromarrayçš„modeå¯ä»¥å‚è€ƒä¸‹è¡¨</p>

<p><img src="/images/md/chap1_modes.png" alt="" /></p>

<p>å–åˆ°çš„å›¾ç‰‡ï¼ˆè¿™ä¸ªä¸æ˜¯æ•°å­—ï¼Œåº”è¯¥æ˜¯è¿™ä¸ªå›¾ç‰‡æœ‰é¢„å¤„ç†ï¼Œæ˜¯ä»pickleé‡Œæ‹¿å‡ºæ¥çš„ï¼‰</p>

<p><img src="/images/md/chap1_book_image.png" alt="" /></p>

<p>å¯¹äºMNISTçš„çœŸæ­£æ•°æ®é›†ï¼Œtrain-images-idx3-ubyteï¼Œç”¨å¦‚ä¸‹æ–¹æ³•æå–</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td> --><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">gzip</span>

<span class="k">def</span> <span class="nf">_read32</span><span class="p">(</span><span class="n">bytestream</span><span class="p">):</span>
  <span class="n">dt</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">uint32</span><span class="p">).</span><span class="n">newbyteorder</span><span class="p">(</span><span class="s">'&gt;'</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">numpy</span><span class="p">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">bytestream</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">extract_images</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">gzip</span><span class="p">.</span><span class="n">GzipFile</span><span class="p">(</span><span class="n">fileobj</span><span class="o">=</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">bytestream</span><span class="p">:</span>
        <span class="n">magic</span> <span class="o">=</span> <span class="n">_read32</span><span class="p">(</span><span class="n">bytestream</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">magic</span> <span class="o">!=</span> <span class="mi">2051</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">'Invalid magic number %d in MNIST image file: %s'</span> <span class="o">%</span>
                             <span class="p">(</span><span class="n">magic</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="n">name</span><span class="p">))</span>
        <span class="n">num_images</span> <span class="o">=</span> <span class="n">_read32</span><span class="p">(</span><span class="n">bytestream</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">_read32</span><span class="p">(</span><span class="n">bytestream</span><span class="p">)</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">_read32</span><span class="p">(</span><span class="n">bytestream</span><span class="p">)</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">bytestream</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span> <span class="o">*</span> <span class="n">num_images</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">num_images</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'train-images-idx3-ubyte.gz'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">extract_images</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">)),</span> <span class="s">'L'</span><span class="p">)</span>
        <span class="n">img</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'/home/cooli7wa/Desktop/%s.png'</span><span class="o">%</span><span class="n">i</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/images/md/chap1_mnist_image.png" alt="" /></p>
:ET