I"[<p>è¿™ç¯‡æ–‡ç« ï¼Œå­¦ä¹ æ“ä½œä¸‹ private dataï¼Œ<a href="https://hyperledger-fabric.readthedocs.io/en/release-1.3/private_data_tutorial.html">æ•™ç¨‹</a>çš„ç¤ºä¾‹å¾ˆæ¸…æ™°ï¼Œæ²¡ä»€ä¹ˆéœ€è¦å¤šè¯´çš„ï¼Œæ‰€ä»¥è¿™ç¯‡ä¼šå¾ˆçŸ­ã€‚</p>

<p>private data ç”¨ collection è¡¨ç¤ºçš„ï¼Œcollection definition æ–‡ä»¶æè¿°äº†æœ‰æƒé™ä½¿ç”¨ã€ä¿å­˜å’Œä¼ æ’­ç§æœ‰æ•°æ®çš„èŠ‚ç‚¹ï¼Œä»¥åŠç§æœ‰æ•°æ®åº”è¯¥è¢«ä¿å­˜å¤šä¹…ã€‚</p>

<p>collection definition åªæœ‰ 5 ä¸ªå‚æ•°ï¼š</p>

<ul>
  <li>nameï¼Œåå­—</li>
  <li>policyï¼Œå®šä¹‰äº†å“ªäº›èŠ‚ç‚¹æœ‰æƒé™ä¿å­˜ç§æœ‰æ•°æ®</li>
  <li>requiredPeerCountï¼ŒèƒŒä¹¦èŠ‚ç‚¹ä¼ æ’­ç§æœ‰æ•°æ®åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œè¿™ä¸ªå‚æ•°å®šä¹‰çš„æ˜¯ä¼ æ’­çš„æœ€å°æ•°é‡</li>
  <li>maxPeerCountï¼Œè¿™ä¸ªå‚æ•°å®šä¹‰çš„æ˜¯ä¼ æ’­çš„æœ€å¤§æ•°é‡</li>
  <li>blockToLiveï¼Œå®šä¹‰äº†ç§æœ‰æ•°æ®åº”è¯¥è¢«ä¿å­˜çš„æ—¶é—´ï¼Œä»¥åŒºå—æ•°é‡ä¸ºå•ä½ï¼Œè¶…æœŸä¹‹åä¼šè¢«åˆ é™¤ï¼Œå¦‚æœæƒ³æ°¸ä¹…ä¿å­˜ï¼Œé‚£ä¹ˆå°±è®¾ä¸º 0</li>
</ul>

<p>collection definition è¢«ä¿å­˜ä¸º json æ–‡ä»¶ï¼Œåœ¨åˆçº¦å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œé€šè¿‡ â€“collections-config å‚æ•°ä¼ å…¥ï¼Œå®˜ç½‘çš„ä¾‹å­å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td> --><td class="rouge-code"><pre>// collections_config.json
[
  {
       "name": "collectionMarbles",
       "policy": "OR('Org1MSP.member', 'Org2MSP.member')",
       "requiredPeerCount": 0,
       "maxPeerCount": 3,
       "blockToLive":1000000
  },

  {
       "name": "collectionMarblePrivateDetails",
       "policy": "OR('Org1MSP.member')",
       "requiredPeerCount": 0,
       "maxPeerCount": 3,
       "blockToLive":3
  }
]
</pre></td></tr></tbody></table></code></pre></div></div>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨åˆçº¦å†…ï¼Œä¹Ÿéœ€è¦é…å¥—çš„ç§æœ‰æ•°æ®ç»“æ„ä½“å®šä¹‰ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td> --><td class="rouge-code"><pre>// Peers in Org1 and Org2 will have this private data in a side database
type marble struct {
  ObjectType string `json:"docType"`
  Name       string `json:"name"`
  Color      string `json:"color"`
  Size       int    `json:"size"`
  Owner      string `json:"owner"`
}

// Only peers in Org1 will have this private data in a side database
type marblePrivateDetails struct {
  ObjectType string `json:"docType"`
  Name       string `json:"name"`
  Price      int    `json:"price"`
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œorg1 å’Œ org2 å¯ä»¥æ“ä½œåå­—ä¸º collectionMarbles çš„æ•°æ®ï¼Œorg1 å¯ä»¥æ“ä½œ collectionMarblePrivateDetails çš„æ•°æ®ã€‚</p>

<p>åˆçº¦å®ä¾‹åŒ–çš„å‘½ä»¤å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†ä¸Šé¢çš„ json æ–‡ä»¶ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
</pre></td> --><td class="rouge-code"><pre>peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n marblesp -v 1.0 -c '{"Args":["init"]}' -P "OR('Org1MSP.member','Org2MSP.member')" --collections-config  $GOPATH/src/github.com/chaincode/marbles02_private/collections_config.json
</pre></td></tr></tbody></table></code></pre></div></div>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

:ET